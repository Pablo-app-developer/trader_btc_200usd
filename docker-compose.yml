version: '3.8'

services:
  # --- TRADING BOTS ---
  trader_sol:
    build:
      context: .
      dockerfile: Dockerfile.bot
    container_name: trader_sol_200usd
    restart: always
    working_dir: /app
    volumes:
      - ./:/app
    command: python run_live_trader.py SOL
    deploy:
      resources:
        limits:
          memory: 2048M

  trader_eth:
    build:
      context: .
      dockerfile: Dockerfile.bot
    container_name: trader_eth_200usd
    restart: always
    working_dir: /app
    volumes:
      - ./:/app
    command: python run_live_trader.py ETH
    deploy:
      resources:
        limits:
          memory: 2048M

  trader_btc:
    build:
      context: .
      dockerfile: Dockerfile.bot
    container_name: trader_btc_200usd
    restart: always
    working_dir: /app
    volumes:
      - ./:/app
    command: python run_live_trader.py BTC
    deploy:
      resources:
        limits:
          memory: 2048M

  # --- DASHBOARD & MONITORING ---
  dashboard:
    build:
      context: .
      dockerfile: Dockerfile.dashboard
    container_name: dashboard_200usd
    restart: always
    working_dir: /app
    volumes:
      - ./:/app
    ports:
      - "8501:8501" # Streamlit
      - "5000:5000" # Healthcheck
    command: sh -c "python healthcheck.py & streamlit run dashboard.py"
